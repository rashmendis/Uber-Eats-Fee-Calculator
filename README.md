<!-- This application was initially generated by AI and may require further refinement. -->

# Uber Eats Fee Calculator - Built with Gemini AI (via Firebase Studio)

This is a simple Next.js application designed to calculate Uber Eats prices, factoring in a configurable fee percentage and an optional offer/discount percentage. It allows users to:

1.  **Calculate Selling Price (Based on Desired Payout + Fee + Optional Offer):** Determine the required selling price to achieve a specific payout after fees and discounts.
2.  **Calculate Payout (Multiple Items with Offers - Fee):** Calculate the total payout for one or more items, each with its own selling price and optional offer, after deducting the Uber fee.

## Features

*   **Selling Price Calculator Tab:**
    *   Enter the **Desired Payout** you want to receive *after* the offer and fee are deducted.
    *   (Optional) Select an **Offer Percentage** (0%, 20%, 30%, 40%, 50%, 75%, or Custom) applied to the Selling Price.
    *   Calculates the required **Selling Price (Before Discount)** using the formula: `SP_Before_Discount = Desired_Payout / ((1 - Offer_Percent) * (1 - Fee_Percent))`.
    *   Shows the **Discount Amount**, **Final Price (Customer Pays)** (`SP_Before_Discount * (1 - Offer_Percent)`), the **Uber Fee** (calculated on the *Final Price*), and verifies the **Actual Payout** matches the input Desired Payout.
*   **Payout Calculator Tab:**
    *   Add one or more items to the calculation.
    *   For each item, enter the **Selling Price (Before Discount)**.
    *   (Optional) For each item, select an **Offer Percentage** (0%, 20%, 30%, 40%, 50%, 75%, or Custom).
    *   Calculates the **Subtotal (Customer Pays)** by summing `SP_Before_Discount * (1 - Offer_Percent)` for all items.
    *   Calculates the **Total Discount Given** across all items.
    *   Calculates the **Total Uber Fee** based on the *Subtotal (Customer Pays)* (`Subtotal_Customer_Pays * Fee_Percent`).
    *   Determines the final **Total Payout (Seller Receives)** (`Subtotal_Customer_Pays - Total_Uber_Fee`).
*   **Configurable Settings:**
    *   Set the fee percentage (defaults to 30%).
    *   Set the currency symbol (defaults to 'Rs.').
*   **Calculation History:** View a history of your past *Selling Price Calculator* calculations in an expandable section. (Multi-item Payout history is not currently saved).
*   **Client-Side Storage:** Settings and history are stored locally in your browser's `localStorage`.
*   **Responsive Design:** Adapts to different screen sizes.

## Live Preview

You can try a live preview of the application here: [Live Preview](https://9000-idx-studio-1746447866480.cluster-fdkw7vjj7bgguspe3fbbc25tra.cloudworkstations.dev)

*(Note: This link might be temporary depending on the hosting environment.)*

## Architecture

This application is built entirely on the **client-side** using Next.js (App Router) and React.

*   **Frontend Framework:** [Next.js](https://nextjs.org/) (with TypeScript)
*   **UI Components:** [shadcn/ui](https://ui.shadcn.com/) built on Radix UI and Tailwind CSS.
*   **Styling:** [Tailwind CSS](https://tailwindcss.com/)
*   **State Management:** React Hooks (`useState`, `useEffect`, `useMemo`, `useCallback`).
*   **Data Storage:** Browser `localStorage` is used to persist user settings and calculation history. **There is no backend server.**

## Getting Started

### Prerequisites

*   [Node.js](https://nodejs.org/) (version 20 or later recommended)
*   [npm](https://www.npmjs.com/) (usually comes with Node.js)

### Installation

1.  Clone the repository:
    ```bash
    git clone <repository-url>
    cd <repository-directory>
    ```
2.  Install dependencies:
    ```bash
    npm install
    ```

### Running the Development Server

To run the app in development mode:

```bash
npm run dev
```

This will start the development server, usually on `http://localhost:9002`. The app will automatically reload if you make changes to the code.

## Usage

1.  **Open the App:** Navigate to the running application in your browser.
2.  **Calculator:**
    *   **Selling Price Calculator Tab:**
        *   Enter the **Desired Payout** (the amount you want to receive *after* offer and fees).
        *   (Optional) Select an **Offer Percentage** from the dropdown or choose "Custom" and enter a percentage (0-100).
        *   Click **Calculate Selling Price**.
        *   The calculator shows:
            *   **Selling Price (Before Discount):** The base price needed.
            *   **Discount Amount:** The value of the offer.
            *   **Final Price (Customer Pays):** The price after the offer.
            *   **Uber Fee:** Calculated on the Final Price.
            *   **Actual Payout:** Should match your Desired Payout input.
        *   *Example:* Desired Payout `Rs. 700`, Fee `30%`, Offer `10%`.
            *   `Required Price After Discount = 700 / (1 - 0.30) = 1000`
            *   `Selling Price Before Discount = 1000 / (1 - 0.10) = 1111.11`
            *   Result: SP (Before Discount) `Rs. 1111.11`, Discount `Rs. 111.11`, Customer Pays `Rs. 1000.00`, Fee `Rs. 300.00`, Actual Payout `Rs. 700.00`.
    *   **Payout Calculator Tab:**
        *   Enter the **Selling Price (Before Discount)** for the first item.
        *   (Optional) Select or enter an **Offer Percentage** for that item.
        *   Click **Add Another Item** to add more items, entering their Selling Price and Offer %.
        *   Click **Calculate Total Payout**.
        *   The calculator shows:
            *   **Subtotal (Customer Pays):** Sum of discounted prices for all items.
            *   **Total Discount Given:** Sum of discounts for all items.
            *   **Total Uber Fee:** Calculated based on the *Subtotal (Customer Pays)*.
            *   **Total Payout (Seller Receives):** The final amount the seller gets (`Subtotal Customer Pays - Total Uber Fee`).
        *   *Example (Two Items):* Fee `30%`
            *   Item 1: SP (Before Disc) `Rs. 1000`, Offer `10%` -> Customer Pays `Rs. 900`
            *   Item 2: SP (Before Disc) `Rs. 500`, Offer `0%` -> Customer Pays `Rs. 500`
            *   Result: Subtotal Customer Pays `Rs. 1400.00`, Total Discount `Rs. 100.00`, Total Fee (`1400 * 0.30`) `Rs. 420.00`, Total Seller Payout (`1400 - 420`) `Rs. 980.00`.
3.  **Settings:**
    *   Click the gear icon (⚙️) in the top-right corner to open the Settings modal.
    *   Adjust the "Uber Fee Percentage" and "Currency Symbol".
    *   Click "Save Changes". Settings are saved in `localStorage`.
4.  **History:**
    *   Expand the "View Calculation History" accordion below the calculator.
    *   Your recent **Selling Price Calculator** calculations will be displayed.
    *   Click the "Clear" button within the history section to remove all saved history entries from `localStorage`.

## LocalStorage Details

The application uses the browser's `localStorage` to store data persistently on your machine.

*   **Settings Key:** `uberFeeCalculatorSettings`
    *   **Format:** JSON string representing an object like `{"feePercentage": 0.3, "currencySymbol": "Rs."}`.
*   **History Key:** `uberFeeCalculatorHistory`
    *   **Format:** JSON string representing an array of calculation objects (currently only for 'selling-price' type calculations). See `src/types/history.ts` for detailed field descriptions.

```json
[
  {
    "id": "unique_id_1",
    "timestamp": 1678886400000,
    "type": "selling-price", // Desired Payout -> SP Before Disc
    "input": 700, // Desired Payout (X)
    "feePercentage": 0.30,
    "discountPercentage": 0.10, // 10% Offer
    "fee": 300, // Fee = (SP_BD * (1-Disc%)) * Fee% = (1111.11 * 0.9) * 0.3 = 1000 * 0.3
    "discountAmount": 111.11, // Discount = SP_BD * Disc% = 1111.11 * 0.10
    "result": 1111.11, // Selling Price Before Discount = DesiredPayout / ((1-Disc%) * (1-Fee%))
    "finalPrice": 1000.00, // Customer Pays = SP_BD * (1 - Disc%)
    "currencySymbol": "Rs."
  }
  // Note: 'payout' type entries (especially multi-item) are not currently added to history
]
```

## Available Scripts

*   `npm run dev`: Starts the Next.js development server with Turbopack.
*   `npm run build`: Builds the application for production.
*   `npm run start`: Starts the production server (requires running `npm run build` first).
*   `npm run lint`: Runs the Next.js linter.
*   `npm run typecheck`: Checks TypeScript types.
